(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{64:function(e,t,n){e.exports=n(96)},69:function(e,t,n){},71:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(21),l=n.n(c),u=(n(69),n(51)),o=n(52),i=n(63),s=n(62),m=(n(70),n(71),n(22)),d=n(5),f=n(100),E=n(101),h=n(103),p=n(104),v=function(){return r.a.createElement(h.a,{bg:"dark",variant:"dark"},r.a.createElement(p.a,{className:"mr-auto",defaultActiveKey:"/home"},r.a.createElement(p.a.Link,{as:m.b,to:"/home"},"Home"),r.a.createElement(p.a.Link,{as:m.b,to:"/get-access"},"Get Access")))},b=n(11),j=n.n(b),k=n(19),g=n(12),O=n(58),y=n.n(O).a.create({baseURL:"/api/",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});y.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(function(e){return Promise.reject(e)}));var w=function(){return y.get("users/").then((function(e){return e.data})).catch((function(e){return e.response.data}))},S=function(e){return y.post("get-access/",{email:e}).then((function(e){return e.data}))},x=function(e){return y.get("set-access/"+e).then((function(e){return e.data}))},A=function(e){return y.get("confirm/?token="+e).then((function(e){return e.data})).catch((function(e){return e.response.data}))},C=function(e){return y.delete("delete/"+e).then((function(e){return e.data})).catch((function(e){return e.response.data}))},N=n(102),I=n(98),q=n(99),L=function(e){var t=e.id,n=e.value,c=Object(a.useRef)(n),l=function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t.currentTarget.id).then((function(e){c.current.checked=e.access}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(N.a.Check,{ref:c,onChange:function(e){return l(e)},checked:n,type:"switch",id:t,value:n,label:""})},R=function(e){var t=Object(a.useState)(!1),n=Object(g.a)(t,2),c=n[0],l=n[1],u=e.users,o=e.isAdmin,i=e.currentUserEmail,s=function(e){!0===window.confirm("Are you sure?")&&C(e).then((function(e){(null===e||void 0===e?void 0:e.logout)&&localStorage.removeItem("token"),l(!0)}))};return r.a.createElement(r.a.Fragment,null,c?r.a.createElement(d.a,{to:"/"}):"",r.a.createElement(I.a,{size:"sm",striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,["#","Email","Token","Hit","Confirmed","Access","delete?"].map((function(e,t){return r.a.createElement("th",{key:t,scope:"col"},e)})))),r.a.createElement("tbody",null,u&&u.length>0&&u.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.email),r.a.createElement("td",null,e.token),r.a.createElement("td",null,e.hit),r.a.createElement("td",null,e.email_confirmed?"Yes":" No"),r.a.createElement("td",null,o?r.a.createElement(L,{id:e.id,value:e.access}):e.access?"Yes":" No"),r.a.createElement("td",null,(o||e.email===i)&&r.a.createElement(q.a,{variant:"danger",size:"sm",onClick:function(t){return s(e.id)}},"del?")))})))))},W=function(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(""),u=Object(g.a)(l,2),o=u[0],i=u[1],s=Object(a.useState)(!1),m=Object(g.a)(s,2),d=m[0],f=m[1],E=Object(a.useState)(!1),h=Object(g.a)(E,2),p=h[0],v=h[1];return Object(a.useEffect)((function(){(function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:!0===(null===(t=e.sent)||void 0===t?void 0:t.access)?(c(t.users),i(t.current_user_email),f(!0),v(t.is_admin)):f(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement("div",null,d?r.a.createElement(R,{users:n,currentUserEmail:o,isAdmin:p}):r.a.createElement("div",null,"Access denied"))},_=n(61),B=function(){var e=Object(a.useState)(!1),t=Object(g.a)(e,2),n=t[0],c=t[1],l=function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=Object(_.a)({initialValues:{email:""},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",t},onSubmit:function(e,t){var n=t.setSubmitting,a=t.setErrors;l(e.email).then((function(e){e.error?a({email:e.message}):c(!0)})),n(!1)}});return r.a.createElement("div",null,n?r.a.createElement(d.a,{to:"/confirm"}):null,r.a.createElement("h1",{className:"mt-5"},"Get access"),r.a.createElement("div",{className:"form-row justify-content-center"},r.a.createElement(N.a,{onSubmit:u.handleSubmit},r.a.createElement(N.a.Group,{controlId:"formBasicEmail"},r.a.createElement(N.a.Label,null,"Email address"),r.a.createElement(N.a.Control,{required:!0,name:"email",type:"email",placeholder:"Enter email",onChange:u.handleChange,value:u.values.email}),u.errors.email?r.a.createElement("div",{className:"text-danger"},u.errors.email):null,r.a.createElement(N.a.Text,{className:"text-muted"},"We'll never share your email with anyone else.")),r.a.createElement(q.a,{variant:"primary",type:"submit"},"Allow Access"))))},T=Object(d.g)((function(e){var t=Object(a.useState)("Check your email, please"),n=Object(g.a)(t,2),c=n[0],l=n[1],u=Object(a.useState)(e.match.params.token),o=Object(g.a)(u,1)[0];return Object(a.useEffect)((function(){o&&function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(o);case 2:(null===(t=e.sent)||void 0===t?void 0:t.token)?(localStorage.setItem("token",t.token),l("Email confirmed!")):(null===t||void 0===t?void 0:t.error)&&l("Wrong token!");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[o]),r.a.createElement("div",null,c)})),z=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement("h2",null,"\u0420\u0435\u0441\u0443\u0440\u0441 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d")}}]),n}(r.a.Component);var G=function(){return r.a.createElement(m.a,null,r.a.createElement(v,null),r.a.createElement(f.a,null,r.a.createElement(E.a,{className:"justify-content-md-center",style:{margin:30}},r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/home",render:function(){return r.a.createElement(W,null)}}),r.a.createElement(d.b,{path:"/get-access",render:function(){return r.a.createElement(B,null)}}),r.a.createElement(d.b,{path:"/confirm/:token?",render:function(){return r.a.createElement(T,null)}}),r.a.createElement(d.a,{exact:!0,from:"/",to:"/home"}),r.a.createElement(d.b,{component:z})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[64,1,2]]]);
//# sourceMappingURL=main.a438bc72.chunk.js.map